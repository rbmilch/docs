<!DOCTYPE HTML>
<html>
<head>
<title>IniRead</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
</head>
<body>

<h1>IniRead</h1>

<p>Liest einen Wert, eine Sektion oder eine Liste mit Sektionsnamen aus einer normalen INI-Datei.</p>

<pre class="Syntax">
<span class="func">IniRead</span>, AusgabeVar, Dateiname, Sektion, Key <span class="optional">, Standardwert</span>
<span class="func">IniRead</span>, AusgabeVarSektion, Dateiname, Sektion
<span class="func">IniRead</span>, AusgabeVarSektionsNamen, Dateiname
</pre>
<h3>Parameter</h3>
<dl>

  <dt>AusgabeVar</dt>
  <dd>
      <p>Name der Variable, in der der abgerufene Wert gespeichert werden soll. Kann der Wert nicht abgerufen werden, wird die Variable auf den <em>Standardwert</em> gesetzt (siehe unten).</p>
    </dd>
  
  <dt>AusgabeVarSektion</dt>
  <dd><p><span class="ver">[AHK_L 57+]:</span> Lassen Sie den <em>Key</em>-Parameter weg, um die ganze Sektion zu lesen. Kommentare und Leerzeilen werden ausgelassen. Nur die ersten 65.533 Zeichen der Sektion werden abgerufen.</p></dd>
  
  <dt>AusgabeVarSektionsNamen</dt>
  <dd><p><span class="ver">[AHK_L 57+]:</span> Lassen Sie den <em>Key</em>- und <em>Sektion</em>-Parameter weg, um eine Liste mit Sektionsnamen abzurufen, die mit Zeilenumbrüchen (<code>`n</code>) voneinander getrennt sind.</p></dd>

  <dt>Dateiname</dt>
  <dd><p>Der Name der Datei, die im <a href="../Variables.htm#WorkingDir">A_WorkingDir</a>-Verzeichnis vermutet wird, wenn kein absoluter Pfad angegeben ist.</p></dd>

  <dt>Sektion</dt>
  <dd><p>Name der Sektion aus der INI-Datei. Sektionen werden mit eckigen Klammern dargestellt (die Klammern dürfen nicht in diesem Parameter stehen).</p></dd>

  <dt>Key</dt>
  <dd><p>Der Key-Name in der INI-Datei.</p></dd>

  <dt>Standardwert</dt>
  <dd><p>Dieser Wert wird in <em>AusgabeVar</em> gespeichert, wenn der angeforderte Key nicht gefunden wurde. Fehlt dieser Parameter, wird er standardmäßig auf das Wort ERROR gesetzt. Um einen leeren Wert (leere Zeichenkette) als Standardwert zu definieren, nutzt man <a href="../Variables.htm#Space">%A_Space%</a>.</p>
      <p><span class="ver">[AHK_L 57+]:</span> Dieser Parameter entfällt, wenn der <i>Key</i>-Parameter fehlt.</p>
      </dd>

</dl>
<h3>ErrorLevel</h3>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird <strong>nicht</strong> von diesem Befehl geändert. Wenn es ein Problem gab, wird <em>AusgabeVar</em> auf den <em>Standardwert</em> gesetzt, wie oben beschrieben.</p>
<h3>Bemerkungen</h3>
<p>Das Betriebsystem entfernt automatisch Leer- und Tabulatorzeichen, die am Anfang oder Ende der abgerufenen Zeichenkette vorkommen. Um das zu verhindern, setzt man die Zeichenkette in einfachen oder doppelten Anführungszeichen. Das äußerste Paar von einfachen oder doppelten Anführungszeichen wird auch entfernt, aber Leerzeichen innerhalb der Anführungszeichen bleiben erhalten.</p>
<p>Werte länger als 65.535 Zeichen dürften zu inkonsistenten Ergebnissen führen.</p>
<p>Eine typische INI-Datei sieht wie folgt aus:</p>
<pre>[Sektionsname]
Key=Value</pre>
<p><b>Unicode</b>: IniRead und IniWrite beziehen sich zum Lesen oder Schreiben von Werten auf die externen Funktionen <a href="https://msdn.microsoft.com/de-de/library/ms724353">GetPrivateProfileString</a> und <a href="https://msdn.microsoft.com/de-de/library/ms725501">WritePrivateProfileString</a>. Diese Funktionen unterstützen Unicode nur in UTF-16-Dateien; alle anderen Dateien verwenden den Standard-ANSI-Zeichensatz des Systems.</p>
<h3>Siehe auch</h3>
<p><a href="IniDelete.htm">IniDelete</a>, <a href="IniWrite.htm">IniWrite</a>, <a href="RegRead.htm">RegRead</a>, <a href="LoopReadFile.htm">Datei-lesende Schleife</a>, <a href="FileRead.htm">FileRead</a></p>
<h3>Beispiel</h3>
<pre class="NoIndent">IniRead, AusgabeVar, C:\Temp\MeineDatei.ini, Sektion2, Key
MsgBox, Der Wert ist %AusgabeVar%.</pre>

</body>
</html>
