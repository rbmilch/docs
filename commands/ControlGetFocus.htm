<!DOCTYPE HTML>
<html>
<head>
<title>ControlGetFocus</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
</head>
<body>

<h1>ControlGetFocus</h1>

<p>Ermittelt, welches Steuerelement des Zielfensters den Eingabefokus hat, falls vorhanden.</p>

<pre class="Syntax"><span class="func">ControlGetFocus</span>, AusgabeVar <span class="optional">, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<h3>Parameter</h3>
<dl>

  <dt>AusgabeVar</dt>
  <dd><p>Name der Variable, in der der Identifikator des Steuerelements gespeichert werden soll. Der Identifikator selbst besteht aus den Klassennamen des Steuerelements, gefolgt von einer laufenden Nummer innerhalb des übergeordneten Fensters, z. B. Button12.</p></dd>

  <dt>Fenstertitel</dt>
  <dd><p>Der Titel oder andere Möglichkeiten zum Identifizieren des Zielfensters. Weitere Informationen finden Sie auf der Seite <a href="../misc/WinTitle.htm">Fenstertitel-Parameter &amp; Zuletzt Gefundenes Fenster</a>.</p></dd>

  <dt>Fenstertext</dt>
  <dd><p>Eine Zeichenkette, die in einem der Textelemente des Zielfensters enthalten ist (eventuell vorhandene Textelemente können mit dem mitgelieferten Windows Spy Tool aufgedeckt werden). Versteckte Textelemente werden nur erkannt, wenn <a href="DetectHiddenText.htm">DetectHiddenText</a> eingeschaltet ist.</p></dd>

  <dt>Titelausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Titel diesen Wert enthalten.</p></dd>

  <dt>Textausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Textelemente diesen Wert enthalten.</p></dd>

</dl>

<h3>ErrorLevel</h3>
<p><span class="ver">[v1.1.04+]</span>: Dieser Befehl ist in der Lage, bei Misserfolg eine Ausnahme auszulösen. Weitere Informationen finden Sie unter <a href="Catch.htm#RuntimeErrors">Laufzeitfehler</a>.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird auf 0 gesetzt, wenn das Steuerelement mit dem Eingabefokus erfolgreich abgerufen werden konnte. Ansonsten (z. B. wenn das Fenster nicht existiert oder kein einziges Steuerelement den Eingabefokus hat) wird ErrorLevel auf 1 gesetzt.</p>
<h3>Bemerkungen</h3>
<p>Das abgerufene Steuerelement ist auch das Steuerelement, das den Tastaturfokus hat; solche Steuerelemente sind die Anlaufstelle für jegliche Tastatureingaben des Benutzers.</p>
<p>Das Fenster muss aktiv sein, damit ein Steuerelement fokussiert sein kann. Ist das Fenster nicht aktiv, wird <em>AusgabeVar</em> leer gemacht.</p>
<p>Vor <span class="ver">[v1.1.19.03]</span> war es so, dass wenn ControlGetFocus mehrmals schnell ausgeführt wurde (also alle 500 ms oder schneller), der Benutzer keinen Doppelklick machen konnte. Diese Problematik wurde behoben.</p>
<p>Fenstertitel und -texte unterscheiden zwischen Groß- und Kleinschreibung. Versteckte Fenster werden nur erkannt, wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> eingeschaltet ist.</p>
<h3>Siehe auch</h3>
<p><a href="ControlFocus.htm">ControlFocus</a>, <a href="ControlMove.htm">ControlMove</a>, <a href="ControlClick.htm">ControlClick</a>, <a href="ControlGetText.htm">ControlGetText</a>, <a href="ControlSetText.htm">ControlSetText</a>, <a href="ControlSend.htm">ControlSend</a></p>
<h3>Beispiel</h3>
<pre class="NoIndent">ControlGetFocus, AusgabeVar, Unbenannt - Editor
if ErrorLevel
    MsgBox, Das Zielfenster existiert nicht oder hat keine Steuerelemente mit Eingabefokus.
else
    MsgBox, Steuerelement mit Eingabefokus = %AusgabeVar%</pre>

</body>
</html>
