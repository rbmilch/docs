<!DOCTYPE HTML>
<html>
<head>
<title>ControlGetPos</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
</head>
<body>

<h1>ControlGetPos</h1>

<p>Ruft die Position und Größe eines Steuerelements ab.</p>

<pre class="Syntax"><span class="func">ControlGetPos</span> <span class="optional">, X, Y, Breite, Höhe, Steuerelement, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme</span></pre>
<h3>Parameter</h3>
<dl>

  <dt>X, Y</dt>
  <dd><p>Namen der Variablen, in denen die X- und Y-Koordinaten  (in Pixel) der oberen linken Ecke des <em>Steuerelements</em> gespeichert werden sollen. Diese Koordinaten sind relativ zur oberen linken Ecke des Zielfensters und damit identisch mit denen, die von <a href="ControlMove.htm">ControlMove</a> benutzt werden.</p>
      <p>Fehlt einer dieser Parameter, wird der entsprechende Wert nicht gespeichert.</p></dd>

  <dt>Breite, Höhe</dt>
  <dd><p>Namen der Variablen, in denen die Breite und Höhe (in Pixel) des <em>Steuerelements</em> gespeichert werden sollen. Fehlt einer dieser Parameter, wird der entsprechende Wert nicht gespeichert.</p></dd>

  <dt>Steuerelement</dt>
  <dd><p>Kann entweder das ClassNN (Klassenname und Instanznummer des Steuerelements) oder der Text des Steuerelements sein, das beides mit Windows Spy ermittelt werden kann. Verwendet man Text, ist das Übereinstimmungsverhalten abhängig von <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a>. Wenn dieser Parameter leer ist, wird das oberste Steuerelement des Fensters benutzt.</p>
    <p>Um ein Steuerelement via HWND (Windows Handle) anzusteuern, lässt man den <em>Steuerelement</em>-Parameter leer und übergibt <code>ahk_id %SteuerelementHwnd%</code> als <em>Fenstertitel</em>-Parameter (funktioniert auch bei versteckten Steuerelementen, selbst wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> ausgeschaltet ist). Das HWND eines Steuerelements wird üblicherweise per <a href="ControlGet.htm#Hwnd">ControlGet Hwnd</a>, <a href="MouseGetPos.htm">MouseGetPos</a> oder <a href="DllCall.htm">DllCall</a> abgerufen.</p></dd>

  <dt>Fenstertitel</dt>
  <dd><p>Der Titel oder andere Möglichkeiten zum Identifizieren des Zielfensters. Weitere Informationen finden Sie auf der Seite <a href="../misc/WinTitle.htm">Fenstertitel-Parameter &amp; Zuletzt Gefundenes Fenster</a>.</p></dd>

  <dt>Fenstertext</dt>
  <dd><p>Eine Zeichenkette, die in einem der Textelemente des Zielfensters enthalten ist (eventuell vorhandene Textelemente können mit dem mitgelieferten Windows Spy Tool aufgedeckt werden). Versteckte Textelemente werden nur erkannt, wenn <a href="DetectHiddenText.htm">DetectHiddenText</a> eingeschaltet ist.</p></dd>

  <dt>Titelausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Titel diesen Wert enthalten.</p></dd>

  <dt>Textausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Textelemente diesen Wert enthalten.</p></dd>

</dl>

<h3>Bemerkungen</h3>
<p>Wenn kein passendes Fenster oder Steuerelement gefunden wird, werden die Ausgabevariablen leer gemacht.</p>
<p>Im Gegensatz zu Befehlen, die ein Steuerelement ändern, erfolgt nach ControlGetPos keine automatische Verzögerung; das heißt, dass <a href="SetControlDelay.htm">SetControlDelay</a> keine Wirkung auf ControlGetPos hat.</p>
<p><a href="MouseGetPos.htm">MouseGetPos</a> kann genutzt werden, um das ClassNN oder HWND des Steuerelements unterhalb des Mauszeigers zu ermitteln. Mit <a href="WinGet.htm">WinGet ControlList</a> kann eine Liste von Steuerelementen abgerufen werden, die in einem Fenster enthalten sind.</p>
<p>Fenstertitel und -texte unterscheiden zwischen Groß- und Kleinschreibung. Versteckte Fenster werden nur erkannt, wenn <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> eingeschaltet ist.</p>
<h3>Siehe auch</h3>
<p><a href="ControlMove.htm">ControlMove</a>, <a href="WinGetPos.htm">WinGetPos</a>, <a href="Control.htm">Control</a>, <a href="ControlGet.htm">ControlGet</a>, <a href="ControlGetText.htm">ControlGetText</a>, <a href="ControlSetText.htm">ControlSetText</a>, <a href="ControlClick.htm">ControlClick</a>, <a href="ControlFocus.htm">ControlFocus</a>, <a href="ControlSend.htm">ControlSend</a></p>
<h3>Beispiel</h3>
<pre class="NoIndent"><em>; Dieses Beispiel zeigt, wie der Name und die Position
; des Steuerelements unterhalb des Mauszeigers fortlaufend aktualisiert und angezeigt werden kann:</em>
Loop
{
    Sleep, 100
    MouseGetPos, , , WelchesFenster, WelchesSteuerelement
    ControlGetPos, x, y, w, h, %WelchesSteuerelement%, ahk_id %WelchesFenster%
    ToolTip, %WelchesSteuerelement%`nX%X%`tY%Y%`nW%W%`t%H%
}</pre>

</body>
</html>
